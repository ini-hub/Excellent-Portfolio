---
import ContactAction from './ContactAction.astro';
import ProjectVisuals from './ProjectVisuals.astro'; // Import the new component

// Define the expected properties (props) for the component
interface Props {
    title: string;
    introduction: string;
    sectionTitle: string;
    sectionContent: string;
    techStack: string[];
    visuals: VisualClassification[]; 
    projectUrl?: string; 
    imageUrl?: string; 
}

// Define the structure for the visual data (same as in ProjectVisuals.astro)
interface VisualClassification {
    title: string;
    id: string;
    images: {
        src: string;
        caption: string;
        link?: string;
    }[];
}

const { 
    title, 
    introduction, 
    sectionTitle, 
    sectionContent, 
    techStack,
    projectUrl,
    imageUrl,
    visuals // Destructure the new prop
} = Astro.props;

// Define a consistent height for your images, e.g., 'h-96' (384px)
const imageHeightClass = "h-48"; 
---

<div class="text-white">
    
    <header class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 text-center">
        <h1 class="text-3xl sm:text-5xl font-extrabold text-yellow-accent mb-4">
            {title}
        </h1>
        <p class="text-lg text-gray-800 max-w-3xl mx-auto">
            {introduction}
        </p>
    </header>
    
    {/* Full-width image section */}
    {imageUrl && (
        <section class={`border rounded-lg border-blue-900 w-full overflow-hidden bg-gray-900 flex justify-center items-center ${imageHeightClass}`}>
            <img 
                src={imageUrl} 
                alt={`${title} Project Screenshot`} 
                class="w-full -full object-cover object-center" 
            />
        </section>
    )}

    {/* Main content grid (Constrained) */}
    <section class="max-w-7xl mx-auto pt-12 px-4 sm:px-6 lg:px-8 grid grid-cols-1 lg:grid-cols-3 gap-10">
        
        {/* Left Column: Project Details & Tech Stack */}
        <div class="lg:col-span-1 bg-gray-800 p-6 rounded-lg shadow-xl h-fit">
            <h2 class="text-2xl font-bold mb-4 border-b border-gray-600 pb-2">
                Project Details
            </h2>
            
            <p class="mb-4">
                <span class="font-semibold text-yellow-accent">Status:</span> Completed
            </p>

            {projectUrl && (
                <p class="mb-6">
                    <span class="font-semibold text-yellow-accent">Live Demo/Repo:</span> 
                    <a href={projectUrl} target="_blank" class="block text-blue-400 hover:text-blue-300 transition duration-150 underline">
                        {projectUrl}
                    </a>
                </p>
            )}

            <h3 class="text-xl font-bold mb-3 text-yellow-accent">
                Tech Stack
            </h3>
            <div class="flex flex-wrap gap-2">
                {techStack.map((tech) => (
                    <span class="bg-deep-blue text-sm font-medium px-3 py-1 rounded-full shadow-md">
                        {tech}
                    </span>
                ))}
            </div>
        </div>
        
        {/* Right Column: Detailed Description */}
        <div class="lg:col-span-2 space-y-6">
            <h2 class="text-3xl font-bold text-yellow-accent">
                {sectionTitle}
            </h2>
            <div class="text-gray-900 leading-relaxed space-y-4" set:html={sectionContent}>
            </div>
            {/* NEW: VISUAL ARTIFACTS SECTION */}
                {visuals.length > 0 && (
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <ProjectVisuals visuals={visuals} />
                    </div>
                )}
        </div>
        
    </section>

    {/* CONTACT ACTION (Placed outside of the main content grid for full-width control) */}
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <ContactAction/>
    </div>
    
</div>